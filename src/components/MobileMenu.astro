---
// Mobile Menu Component with slide-in overlay
---

<!-- Hamburger Button -->
<button
  id="mobile-menu-toggle"
  type="button"
  class="lg:hidden flex flex-col justify-center items-center w-11 h-11 gap-1.5 z-50 -mr-1"
  aria-label="Menü öffnen"
  aria-expanded="false"
  aria-controls="mobile-menu"
>
  <span class="hamburger-line w-6 h-0.5 bg-dark transition-all duration-300 origin-center"></span>
  <span class="hamburger-line w-6 h-0.5 bg-dark transition-all duration-300"></span>
  <span class="hamburger-line w-6 h-0.5 bg-dark transition-all duration-300 origin-center"></span>
</button>

<!-- Mobile Menu Overlay -->
<div
  id="mobile-menu"
  class="fixed inset-0 bg-sand z-40 transform translate-x-full transition-transform duration-300 ease-in-out lg:hidden"
  aria-hidden="true"
>
  <div class="flex flex-col items-center justify-center h-full gap-8 p-8">
    <nav class="flex flex-col items-center gap-6">
      <a href="#themen" class="mobile-nav-link text-2xl font-headline uppercase text-dark hover:text-primary transition-colors">
        Themen
      </a>
      <a href="/wahlprogramm" class="mobile-nav-link text-2xl font-headline uppercase text-dark hover:text-primary transition-colors">
        Wahlprogramm
      </a>
      <a href="#wahlhilfe" class="mobile-nav-link text-2xl font-headline uppercase text-dark hover:text-primary transition-colors">
        Wahlhilfe
      </a>
      <a href="#termine" class="mobile-nav-link text-2xl font-headline uppercase text-dark hover:text-primary transition-colors">
        Termine
      </a>
      <a href="#kontakt" class="mobile-nav-link text-2xl font-headline uppercase text-dark hover:text-primary transition-colors">
        Kontakt
      </a>
    </nav>
    <a href="#mitmachen" class="btn btn-primary text-lg mt-4">
      Mitmachen
    </a>
  </div>
</div>

<style>
  /* Hamburger animation when menu is open */
  .menu-open .hamburger-line:nth-child(1) {
    transform: translateY(8px) rotate(45deg);
  }
  .menu-open .hamburger-line:nth-child(2) {
    opacity: 0;
  }
  .menu-open .hamburger-line:nth-child(3) {
    transform: translateY(-8px) rotate(-45deg);
  }

  /* Menu open state */
  .menu-open #mobile-menu {
    transform: translateX(0);
  }
</style>

<script>
  const toggle = document.getElementById('mobile-menu-toggle');
  const menu = document.getElementById('mobile-menu');
  const body = document.body;

  if (toggle && menu) {
    const navLinks = menu.querySelectorAll('.mobile-nav-link');
    const focusableElements = menu.querySelectorAll('a, button');
    const firstFocusable = focusableElements[0];
    const lastFocusable = focusableElements[focusableElements.length - 1];

    const openMenu = () => {
      body.classList.add('menu-open', 'overflow-hidden');
      toggle.setAttribute('aria-expanded', 'true');
      toggle.setAttribute('aria-label', 'Menü schließen');
      menu.setAttribute('aria-hidden', 'false');
      if (firstFocusable) {
        setTimeout(() => {
          firstFocusable.focus();
        }, 50);
      }
    };

    const closeMenu = () => {
      body.classList.remove('menu-open', 'overflow-hidden');
      toggle.setAttribute('aria-expanded', 'false');
      toggle.setAttribute('aria-label', 'Menü öffnen');
      menu.setAttribute('aria-hidden', 'true');
    };

    toggle.addEventListener('click', () => {
      if (body.classList.contains('menu-open')) {
        closeMenu();
      } else {
        openMenu();
      }
    });

    navLinks.forEach((link) => {
      link.addEventListener('click', closeMenu);
    });

    document.addEventListener('keydown', (e) => {
      if (!body.classList.contains('menu-open')) return;

      if (e.key === 'Escape') {
        closeMenu();
        toggle.focus();
        return;
      }

      if (e.key === 'Tab' && focusableElements.length > 0) {
        if (e.shiftKey) {
          if (document.activeElement === firstFocusable || document.activeElement === toggle) {
            e.preventDefault();
            if (lastFocusable) lastFocusable.focus();
          }
        } else {
          if (document.activeElement === lastFocusable) {
            e.preventDefault();
            if (firstFocusable) firstFocusable.focus();
          }
        }
      }
    });
  }
</script>
